[2024-03-19T04:12:32.992+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: upload_historical_congress_data.upload_historical_bills scheduled__2024-03-15T00:00:00+00:00 [queued]>
[2024-03-19T04:12:32.999+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: upload_historical_congress_data.upload_historical_bills scheduled__2024-03-15T00:00:00+00:00 [queued]>
[2024-03-19T04:12:33.001+0000] {taskinstance.py:2193} INFO - Starting attempt 3 of 3
[2024-03-19T04:12:33.014+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): upload_historical_bills> on 2024-03-15 00:00:00+00:00
[2024-03-19T04:12:33.021+0000] {standard_task_runner.py:60} INFO - Started process 109 to run task
[2024-03-19T04:12:33.025+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'upload_historical_congress_data', 'upload_historical_bills', 'scheduled__2024-03-15T00:00:00+00:00', '--job-id', '42', '--raw', '--subdir', 'DAGS_FOLDER/upload_historical_congress_data.py', '--cfg-path', '/tmp/tmpet_bi3oo']
[2024-03-19T04:12:33.029+0000] {standard_task_runner.py:88} INFO - Job 42: Subtask upload_historical_bills
[2024-03-19T04:12:33.089+0000] {task_command.py:423} INFO - Running <TaskInstance: upload_historical_congress_data.upload_historical_bills scheduled__2024-03-15T00:00:00+00:00 [running]> on host d441bfe1c21b
[2024-03-19T04:12:33.149+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='***@***.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='upload_historical_congress_data' AIRFLOW_CTX_TASK_ID='upload_historical_bills' AIRFLOW_CTX_EXECUTION_DATE='2024-03-15T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='3' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-15T00:00:00+00:00'
[2024-03-19T04:12:33.158+0000] {get_bills.py:84} INFO - executing API call for https://api.congress.gov/v3/bill?format=json&fromDateTime=2023-03-13T00:00:00Z&toDateTime=2024-03-15T00:00:00Z&offset=0&limit=250&api_key=WNue8kCDCOIlewAsULgnN8j6SqSgAZjE2sYbPsBb
[2024-03-19T04:12:34.608+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
  File "/home/airflow/.local/lib/python3.8/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
  File "/opt/airflow/dags/scripts/python/get_bills.py", line 75, in get_and_upload_bills
    upload_to_gcs_as_parquet(bills=bills,
  File "/opt/airflow/dags/scripts/python/get_bills.py", line 125, in upload_to_gcs_as_parquet
    client = storage.Client()
  File "/home/airflow/.local/lib/python3.8/site-packages/google/cloud/storage/client.py", line 226, in __init__
    super(Client, self).__init__(
  File "/home/airflow/.local/lib/python3.8/site-packages/google/cloud/client/__init__.py", line 320, in __init__
    _ClientProjectMixin.__init__(self, project=project, credentials=credentials)
  File "/home/airflow/.local/lib/python3.8/site-packages/google/cloud/client/__init__.py", line 268, in __init__
    project = self._determine_default(project)
  File "/home/airflow/.local/lib/python3.8/site-packages/google/cloud/client/__init__.py", line 287, in _determine_default
    return _determine_default_project(project)
  File "/home/airflow/.local/lib/python3.8/site-packages/google/cloud/_helpers/__init__.py", line 152, in _determine_default_project
    _, project = google.auth.default()
  File "/home/airflow/.local/lib/python3.8/site-packages/google/auth/_default.py", line 657, in default
    credentials, project_id = checker()
  File "/home/airflow/.local/lib/python3.8/site-packages/google/auth/_default.py", line 650, in <lambda>
    lambda: _get_explicit_environ_credentials(quota_project_id=quota_project_id),
  File "/home/airflow/.local/lib/python3.8/site-packages/google/auth/_default.py", line 270, in _get_explicit_environ_credentials
    credentials, project_id = load_credentials_from_file(
  File "/home/airflow/.local/lib/python3.8/site-packages/google/auth/_default.py", line 118, in load_credentials_from_file
    with io.open(filename, "r") as file_obj:
IsADirectoryError: [Errno 21] Is a directory: '/.google/credentials/google_credentials.json'
[2024-03-19T04:12:34.625+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=upload_historical_congress_data, task_id=upload_historical_bills, execution_date=20240315T000000, start_date=20240319T041232, end_date=20240319T041234
[2024-03-19T04:12:34.636+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 42 for task upload_historical_bills ([Errno 21] Is a directory: '/.google/credentials/google_credentials.json'; 109)
[2024-03-19T04:12:34.681+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-03-19T04:12:34.693+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
[2024-04-02T03:02:12.301+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=non-requeueable deps ti=<TaskInstance: upload_historical_congress_data.upload_historical_bills scheduled__2024-03-15T00:00:00+00:00 [queued]>
[2024-04-02T03:02:12.307+0000] {taskinstance.py:1979} INFO - Dependencies all met for dep_context=requeueable deps ti=<TaskInstance: upload_historical_congress_data.upload_historical_bills scheduled__2024-03-15T00:00:00+00:00 [queued]>
[2024-04-02T03:02:12.307+0000] {taskinstance.py:2193} INFO - Starting attempt 3 of 3
[2024-04-02T03:02:12.314+0000] {taskinstance.py:2217} INFO - Executing <Task(PythonOperator): upload_historical_bills> on 2024-03-15 00:00:00+00:00
[2024-04-02T03:02:12.319+0000] {standard_task_runner.py:60} INFO - Started process 102 to run task
[2024-04-02T03:02:12.322+0000] {standard_task_runner.py:87} INFO - Running: ['***', 'tasks', 'run', 'upload_historical_congress_data', 'upload_historical_bills', 'scheduled__2024-03-15T00:00:00+00:00', '--job-id', '86', '--raw', '--subdir', 'DAGS_FOLDER/upload_historical_congress_data.py', '--cfg-path', '/tmp/tmpa39jqj95']
[2024-04-02T03:02:12.325+0000] {standard_task_runner.py:88} INFO - Job 86: Subtask upload_historical_bills
[2024-04-02T03:02:12.359+0000] {task_command.py:423} INFO - Running <TaskInstance: upload_historical_congress_data.upload_historical_bills scheduled__2024-03-15T00:00:00+00:00 [running]> on host 308c9d5b795d
[2024-04-02T03:02:12.418+0000] {taskinstance.py:2513} INFO - Exporting env vars: AIRFLOW_CTX_DAG_EMAIL='***@***.com' AIRFLOW_CTX_DAG_OWNER='***' AIRFLOW_CTX_DAG_ID='upload_historical_congress_data' AIRFLOW_CTX_TASK_ID='upload_historical_bills' AIRFLOW_CTX_EXECUTION_DATE='2024-03-15T00:00:00+00:00' AIRFLOW_CTX_TRY_NUMBER='3' AIRFLOW_CTX_DAG_RUN_ID='scheduled__2024-03-15T00:00:00+00:00'
[2024-04-02T03:02:12.421+0000] {get_data.py:172} INFO - Max records passed as 1000
[2024-04-02T03:02:12.422+0000] {get_data.py:262} INFO - executing API call for https://api.congress.gov/v3/bill?format=json&fromDateTime=2024-03-01T00:00:00Z&toDateTime=2024-03-15T00:00:00Z&offset=0&limit=250&congress=118&api_key=WNue8kCDCOIlewAsULgnN8j6SqSgAZjE2sYbPsBb
[2024-04-02T03:02:18.255+0000] {taskinstance.py:2731} ERROR - Task failed with exception
Traceback (most recent call last):
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 444, in _execute_task
    result = _execute_callable(context=context, **execute_callable_kwargs)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/models/taskinstance.py", line 414, in _execute_callable
    return execute_callable(context=context, **execute_callable_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 200, in execute
    return_value = self.execute_callable()
                   ^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/airflow/.local/lib/python3.11/site-packages/airflow/operators/python.py", line 217, in execute_callable
    return self.python_callable(*self.op_args, **self.op_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/airflow/dags/scripts/python/get_data.py", line 185, in get_and_upload_data
    logging.into(f'About to start fetching {records_to_fetch} records')
    ^^^^^^^^^^^^
AttributeError: module 'logging' has no attribute 'into'
[2024-04-02T03:02:18.274+0000] {taskinstance.py:1149} INFO - Marking task as FAILED. dag_id=upload_historical_congress_data, task_id=upload_historical_bills, execution_date=20240315T000000, start_date=20240402T030212, end_date=20240402T030218
[2024-04-02T03:02:18.292+0000] {standard_task_runner.py:107} ERROR - Failed to execute job 86 for task upload_historical_bills (module 'logging' has no attribute 'into'; 102)
[2024-04-02T03:02:18.346+0000] {local_task_job_runner.py:234} INFO - Task exited with return code 1
[2024-04-02T03:02:18.389+0000] {taskinstance.py:3312} INFO - 0 downstream tasks scheduled from follow-on schedule check
